<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie10 lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie10 lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js lt-ie10" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
	<head>
	    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
	    <meta name="viewport" content="width=device-width" />
	    <title>Creating dynamic pie graphs using CSS — Cornæ</title>
	    <meta name="Language" content="en" />
	    <link rel="stylesheet" href="/style/base.css" type="text/css" media="screen" charset="utf-8" />   
	    <script src="http://www.patternslib.com/bundles/patterns.min.js" type="text/javascript"></script> 
	</head>
	<body class="post mood-blueberry">
		<div id="main" class="pat-auto-scale" data-pat-auto-scale="method: zoom; min-width: 769">
			      <div id="prologue">
        <h1>
          Creating dynamic pie graphs using CSS
        </h1>
        <p class="byline">
          Cornelis G.A. Kolbach, December, 23, 2005
        </p>
        <p class="introduction">
          OAfter all the positive responses to my article on creating dynamic column graphs using CSS, I decided to go one step further and publish a method to create dynamic 3-dimensional pie graphs, again based CSS and xHTML.
        </p>
      </div>
      <div id="contentBody">
        <h3 id='the_graphics'>The graphics</h3>

<p>The image below shows the desired end result. The pie is built up out of serveral layers of graphics on top of each other. Much like layers in Photoshop.</p>

<p><img alt='Pie' src='/media/pie.png' /></p>

<p>The plum colour is the bottom layer, on top of it apple, then grape, lime, banana, avocado, blueberry, cherry and chocolate. (anti-clockwise). The top layer covers all the other segments. It&#8217;s a white square with a hole in it and it has the black ring on it.</p>

<p><img alt='Pie in layers' src='/media/pieGraphLayers.png' /></p>

<ol>
<li>The cover layer with it&#8217;s cut out. The hole contains a half opaque, radial gradient, which causes the soft shadows on the segments underneath.</li>

<li>The stacked segments.</li>
</ol>

<p>An image was created for each percentage of that layer. This makes a total of 100 images per colour. In order to view the graph in perspective, an oblong square was created in Photoshop, of which each side was divided into 25 segments. Added up, this makes 100 segments. Now it&#8217;s easy to align the gap of the shape to each crossing point along the sides of the matrix.</p>

<p><img alt='Slice' src='/media/slice.png' /></p>

<h3 id='the_markup'>The markup</h3>

<p>Each layer is in the markup represented by it&#8217;s own <code>div</code>. To be able to generate the graph dynamically, an image will be assigned to each div by means of an inline style element. The first div is the bottom layer, the second div is the layer above it, etc. The last div has a class &#8220;pieGraph-super&#8221;. This is the cover layer.</p>

<p>The file name of each used image, such as <code>pieGraph-plum-100p.png</code>, consists of a colour indication and a number. The number indicates how much of the pie will be occupied by that layer. So, <code>100p</code> for instance, stands for 100 percent. From now on we call this value, the &#8216;p-value&#8217;. The p-value of the first layer (visually the bottom layer, but in the first layer mentioned in the markup) will always be set to a 100 percent. The p-value of each next layer will calculated like: p-value of previous layer, minus the desired &#8216;real&#8217; value of that layer.</p>

<h3 id='the_style_sheet'>The style sheet</h3>

<p>The dimensions of the mother div, in this case 450 pixels times 170 pixels, is the first thing we add to the style sheet. Next we indicated that the division should act as a block level element.</p>

<pre><code>div#pieGraph {
  width: 420px;
  height: 170px;
  float: left;
  display: block;
  position: relative;
}</code></pre>

<p>It&#8217;s important to give the division a relative position. With this division, all the layers for the pieces of the pie will be &#8216;stacked&#8217;. We want the layers to end up on top of each other and not underneath each other. Therefor we write: <code>position: relative;</code>.</p>

<p>The behaviour for all div elements within <code>div#pieGraph</code> now may be stipulated under <code>div#pieGraph div</code> in the CSS file. Again, the dimensions of the layer will be fixed. This value is the same for all layers. The line <code>position: absolute</code> means that every layer with position itself at coordinate 0:0, as apposed to the next higher element with a relative, or absolute positioning. In this case: the mother division of the graph. This way, we can make sure that all layers will be stacked upon each other, rather than be rendered underneath each other in the browser.</p>

<pre><code>div#pieGraph div {
  width: 420px;
  height: 170px;
  display: block;
  position: absolute;
}</code></pre>

<p>We now get the following result:</p>

<p><img alt='Between' src='/media/between.png' /></p>

<p>We neatly cover the layer with the top layer by simply adding <code>&lt;div class=&quot;pieGraph-super&quot;&gt;&lt;/div&gt;</code> to the markup. Now the graph is finished. That is… almost.</p>

<h4 id='the_little_mproblem'>The little &#8216;M-problem&#8217;</h4>

<p>The file format of choice for images of the pieces of the pie is the <a href='http://www.w3.org/Graphics/PNG/'><strong>P</strong>ortable <strong>N</strong>etwork <strong>G</strong>raphics format</a>. It&#8217;s support for transparancy in different grades makes it ideal for stacking all the different graphics that contain lots of diagonal lines and curves. These lines and curves would look rather jagged if the GIF-format was used instead. Besides that, the subtle shadow that&#8217;s genereated by the top layer, would not have been possible at all in this way. Although PNG has been a common standard since 1996, Microsoft will only start to fully support this open format in version 7 of their popular web browser Internet Explorer. For now, we&#8217;ll have to offer Internet Explorer users an alternative in the form of a GIF alternative of the graph.</p>

<p>Every layer now needs to be added twice to the markup:</p>

<p>Now it&#8217;s quite easy to hide All layers that contain PNG images in Internet Explorer and to hide all layers that contain a GIF image in other browsers, by means of a simple <a href='http://www.dithered.com/css_filters/css_only/child_selector.html'>child selector hack</a>.</p>

<pre><code>div.ifMSIE {
  visibility: visible;
}

html&gt;body div.ifMSIE {
  visibility: hidden;
}

.ifOther {
  visibility: hidden;
}

html&gt;body .ifOther {
  visibility: visible;
}</code></pre>

<p>The image below, shows the end result in both Internet Explorer 6.0 and an other grahpical browser. As you can see, the end result in Internet Explorer is not quite as stunning as in other browser, but it&#8217;s still more than usable and just as clear as the render result in more modern browsers. See what the <a href='/media/pieGraph/pieGraph.html'>end result</a> looks like in your browser.</p>

<p><img alt='Pie graph in Internet Explorer' src='/media/pieGraphIEvsOther.gif' /></p>

<ol>
<li><strong>Left:</strong> The render result in Internet Explorer 6.0.</li>

<li><strong>Right:</strong> The render result in modern browsers.</li>
</ol>
	  </div>
        
      <div id="disqus_thread"></div>
      <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'cornae'; // required: replace example with your forum shortname
  
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      

			<ul class="navigation" id="globalNavigation">
				<li id="portaltab-home" class="home">
					<a href="">Home</a>
				</li>
				<li class="contact">
					<a href="/about.html">About</a>
				</li>
				<li class="articles">
					<a href="/articles.html">Articles</a>
				</li>
				<li class="portfolio">
					<a href="/portfolio.html">Portfolio</a>
				</li>
			</ul>

	        <form action="/search-results.html" id="search">
	        	<input type="search" placeholder="Search" name="q" id="tipue_search_input">
	        </form>
	        
	        <ul id="colours">
				<li class="blueberry pat-switch" data-pat-switch="selector: body; remove: mood-*; add: mood-blueberry; store: local">
					Blueberry
				</li>
				<li class="topaz pat-switch" data-pat-switch="selector: body; remove: mood-*; add: mood-topaz; store: local">
					Topaz
				</li>
				<li class="orchid pat-switch" data-pat-switch="selector: body; remove: mood-*; add: mood-orchid; store: local">
					Orchid
				</li>
				<li class="mocha pat-switch" data-pat-switch="selector: body; remove: mood-*; add: mood-mocha; store: local">
					Mocha
				</li>
				<li class="avocado pat-switch" data-pat-switch="selector: body; remove: mood-*; add: mood-avocado; store: local">
					Avocado
				</li>
	        </ul>
	    </div>

        <div class="addthis_toolbox addthis_default_style addthis_32x32_style" id="share">
         	<a class="addthis_button_preferred_1"></a>
         	<a class="addthis_button_preferred_2"></a>
        </div>
        
        <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=cornae"></script>
        
        <a href="#main" id="top" name="top">Back to top</a>
  </body>
</html>
